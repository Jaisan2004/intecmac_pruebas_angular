<app-menu></app-menu>

<ngx-spinner size="medium" color="#fff" type="square-jelly-box">
    <p style="color: white"> Cargando... </p>
  </ngx-spinner>
  
<div id="cuerpo">
    <div class="container">

        <button class="btn btn-outline-dark" title="Volver al listado de Roles" routerLink="/Roles"><i class="bi bi-box-arrow-left"></i></button>
        <h1>Modificar Rol</h1>
        <br>
        <form class="row  g-3" [formGroup]="formRoles">

            <!-- Username -->
            <div class="form-floating mb-3">

                <input class="form-control" type="text" id="rol_nombre" formControlName="rol_nombre">
                <label class="form-label" for="rol_nombre" style="color: green;" *ngIf="rol_nombre.valid">* Nombre del Rol</label>
                <label class="form-label" for="rol_nombre" style="color: red;" *ngIf="rol_nombre.invalid">* Nombre del Rol</label>

                <div class="alert alert-danger" [hidden]="rol_nombre.pristine || rol_nombre.valid">
                    <span *ngIf="rol_nombre.errors?.['required']">Por favor ingrese el Nombre del Rol.</span>
                    <span *ngIf="rol_nombre.errors?.['maxlength']">Hay mas de 100 caracteres.</span>
                </div>

            </div>

            <!-- Tabla de Permisos -->
            <section class="example-container mat-elevation-z8" tabindex="0">
                <div class="row">
                    <div class="mb-3 col-md-3">
                        <button class="btn btn-success btn-sm" (click)="BotonAgregarPermisos()"><i
                                class="bi bi-plus-square-fill"></i> Agregar Producto</button>
                    </div>
                    <div class="mb-3 col-md-8">
                    </div>
                    <div class="mb-3 col-md-1">
                        <button class="btn btn-light" (click)="getPermisos()"><i
                                class="bi bi-arrow-clockwise"></i></button>
                    </div>
                </div>

                <form class="row  g-3" [formGroup]="formPermisos"
                    *ngIf="permisosNuevo == true|| permisosModificar == true">

                    <div class="form-floating mb-3">

                        <select id="producto" class="form-select"
                            aria-label="Default select example" name="producto" formControlName="producto">

                            <option disabled selected>---Seleccione un producto---</option>
                            <option>prueba</option>

                        </select>

                        <label class="form-label" for="producto" style="color: green;" *ngIf="producto.valid">*
                            Producto</label>
                        <label class="form-label" for="producto" style="color: red;" *ngIf="producto.invalid">*
                            Producto</label>

                        <div class="alert alert-danger" [hidden]="producto.untouched || producto.valid">
                            <span>Por favor seleccione el producto.</span>
                        </div>

                    </div>
                    <div class="form-floating mb-3 col-md-6">

                        <input class="form-control" name="lote" type="text" id="lote" formControlName="lote">

                        <label class="form-label" for="lote" style="color: green;" *ngIf="lote.valid">*
                            Lote</label>
                        <label class="form-label" for="lote" style="color: red;" *ngIf="lote.invalid">*
                            Lote</label>

                        <div class="alert alert-danger" [hidden]="lote.pristine || lote.valid">
                            <span *ngIf="lote.errors?.['required']">Por favor ingrese el lote.</span>
                            <span *ngIf="lote.errors?.['maxlength']">El lote supera los 99 caracteres.</span>
                        </div>
                    </div>

                    <div class="form-floating mb-3 col-md-6">

                        <input class="form-control" name="cantidad" type="number" id="cantidad"
                            formControlName="cantidad">

                        <label class="form-label" for="cantidad" style="color: green;" *ngIf="cantidad.valid">*
                            Cantidad</label>
                        <label class="form-label" for="cantidad" style="color: red;" *ngIf="cantidad.invalid">*
                            Cantidad</label>

                        <div class="alert alert-danger" [hidden]="cantidad.pristine || cantidad.valid">
                            <span *ngIf="cantidad.errors?.['required']">Por favor ingrese la cantidad.</span>
                            <span *ngIf="cantidad.errors?.['max']">la cantidad supera los 8 caracteres.</span>
                        </div>

                    </div>

                    <!-- Cancelar -->
                    <div class="mb-3 col-md-6">
                        <button title="Cancelar" type="submit" class="btn btn-secondary btn-sm"
                            style="width: 100%;"
                            (click)="BotonCancelarPermisos()">Cancelar</button>
                    </div>
                    <!-- Registrar Prodcuto -->
                    <div class="mb-3 col-md-6" *ngIf="permisosNuevo">
                        <button type="submit" class="btn btn-primary btn-sm" style="width: 100%;"
                             title="Registrar Producto de la PQRS"
                            [disabled]="formPermisos.invalid||loading">{{(loading)?'Cargando...'
                            : 'Registrar Producto'}}</button>
                    </div>

                    <div class="mb-3 col-md-6" *ngIf="permisosModificar">
                        <button type="submit" class="btn btn-primary btn-sm" style="width: 100%;"
                             title="Modificar Producto de la PQRS"
                            [disabled]="formPermisos.invalid||loading">{{(loading)?'Cargando...'
                            : 'Modificar Producto'}}</button>
                    </div>

                    <div class="alert alert-danger" [hidden]="formPermisos.valid">
                        <p>Por favor, complete todos los campos obligatorios marcados con un asterisco (*) antes de
                            registrar el
                            Producto. Además, asegúrese de que no quede ningún campo resaltado en rojo.</p>
                    </div>
                </form>
                <div class="example-table-container">
                    <table mat-table [dataSource]="dataSource" class="example-table" matSort>

                        <ng-container *ngFor="let column of columns" [matColumnDef]="column.name">
                            <th mat-header-cell *matHeaderCellDef [mat-sort-header]="column.prop"> {{column.titulo}}
                            </th>
                            <td mat-cell *matCellDef="let element"> {{element[column.prop]}} </td>
                        </ng-container>

                        <ng-container matColumnDef="Acciones" stickyEnd>
                            <th mat-header-cell *matHeaderCellDef> Acciones </th>
                            <td mat-cell *matCellDef="let element">

                                <button class="btn btn btn-outline-light" title="Modificar PQRS"
                                    >

                                    <img src="../../../assets/img/lapiz.png">

                                </button>
                            </td>
                        </ng-container>

                        <tr mat-header-row *matHeaderRowDef="displayedColumns; sticky: true"></tr>
                        <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
                    </table>
                </div>
                <mat-paginator [pageSizeOptions]="[3, 5, 7]" showFirstLastButtons
                    aria-label="Select page of periodic elements">
                </mat-paginator>
            </section>

            <div class="mb-3 col-md-6">
                <button type="submit" title="Volver al listado de Roles" class="btn btn-secondary" style="width: 100%;" routerLink="/Roles">Volver</button>
            </div>
            <div class="mb-3 col-md-6">
                <button type="submit" title="Registrar al Cliente" class="btn btn-primary" style="width: 100%;" (click)="modificarRol()"
                    [disabled]="formRoles.invalid||loading">{{(loading)?'Cargando...'
                    : 'Actualizar'}}</button>
            </div>

            <div class="alert alert-danger"  [hidden]="formRoles.valid">
                <p>Por favor, complete todos los campos obligatorios marcados con un asterisco (*) antes de enviar el formulario. Además, asegúrese de que no quede ningún campo resaltado en rojo.</p>
            </div>
        </form>


    </div>
</div>
